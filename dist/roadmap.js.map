{"version":3,"sources":["webpack:///roadmap.js","webpack:///webpack/bootstrap 5a9e414fcffb9faf73de","webpack:///C:/Users/BBA/Documents/GitHub/roadmap/source/js/roadmap.js","webpack:///C:/Users/BBA/Documents/GitHub/roadmap/source/js/helper.js","webpack:///C:/Users/BBA/Documents/GitHub/roadmap/source/js/view.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireWildcard","obj","__esModule","newObj","key","Object","prototype","hasOwnProperty","_helper","helper","_view","view","$","broadcast","roadmap","set","store","showUserStats","stats","statRules","map","rule","most","value","visa","less","handleRule","currentVisa","index","fn","userStats","stat","userVisa","forEach","text","swap","direction","this","parents","data","refIndex","storeReference","indexOf","historyRef","history","push","time","Firebase","ServerValue","TIMESTAMP","hash","window","location","replace","baseDomain","host","base","room","child","reference","threshold","presence","thresholdValue","showingStats","on","newStoreResp","val","renderRoadmap","renderReference","limitToLast","childSnapshot","event","renderActionNotification","removeClass","setTimeout","addClass","onAuth","authData","uid","console","log","amOnline","userRef","snapshot","onDisconnect","remove","focus","displayOnline","chart","c3","generate","x","columns","type","axis","y","padding","tick","format","date","Date","format2","getHours","getMinutes","transition","duration","times","saved","users","itemStats","nbPoints","historyLength","now","eventVisa","user","getOrSet","up","down","total","toRef","againstRef","item","upUsers","downUsers","setInterval","Math","floor","remaining","length","i","unshift","shift","eventTime","lastTime","timeIndex","currentStats","concat","load","toggleClass","$item","parseInt","isNaN","content","JSON","stringify","ref","downloadAsFile","Blob","originalEvent","dataTransfer","dropEffect","file","files","reader","FileReader","onload","e","parse","target","result","X_x","readAsText","splice","hasClass","effectAllowed","setData","find","$this","preventDefault","stopPropagation","targetIndex","originIndex","getData","hide","login","authAnonymously","error","show","unauth","trigger","int","filename","saveAs","navigator","msSaveBlob","bind","downloadLink","document","createElement","href","URL","createObjectURL","setAttribute","body","appendChild","click","removeChild","object","defaultValue","defineProperty","changed","isReference","isCandidate","markup","isNotLast","$element","join","attr","$elementContainer","newStoreView","nbItems","html","append","thresholdMarkup","storeView","online","$online"],"mappings":"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","file":"roadmap.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*global $ Firebase c3:true*/\n\t'use strict';\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\t\n\tvar _helper = __webpack_require__(1);\n\t\n\tvar helper = _interopRequireWildcard(_helper);\n\t\n\tvar _view = __webpack_require__(2);\n\t\n\tvar view = _interopRequireWildcard(_view);\n\t\n\t$(function () {\n\t\n\t\tvar hash = 'room_' + window.location.hash.replace(/[\\#\\.\\[\\]\\$]/g, '');\n\t\t// DEV - PROD switch\n\t\tvar baseDomain = window.location.host.indexOf('localhost') !== -1 ? 'roadmap2' : 'amber-torch-7267';\n\t\n\t\tvar base = new Firebase('https://' + baseDomain + '.firebaseio.com/');\n\t\tvar room = base.child(hash);\n\t\tvar roadmap = room.child('roadmap');\n\t\tvar reference = room.child('reference');\n\t\tvar threshold = room.child('threshold');\n\t\tvar history = room.child('history');\n\t\tvar presence = room.child('presence');\n\t\n\t\t/**\n\t  *\n\t  * SHARED VARS\n\t  *\n\t  */\n\t\n\t\tvar store = [];\n\t\tvar storeReference = [];\n\t\tvar thresholdValue = 0;\n\t\tvar showingStats = false;\n\t\n\t\t/**\n\t  *\n\t  * FUNCTIONAL\n\t  *\n\t  */\n\t\n\t\troadmap.on('value', function (newStoreResp) {\n\t\t\tstore = newStoreResp.val() || [];\n\t\t\tview.renderRoadmap(store, thresholdValue);\n\t\t});\n\t\treference.on('value', function (data) {\n\t\t\tstoreReference = data.val() || [];\n\t\t\tview.renderReference(storeReference, thresholdValue);\n\t\t});\n\t\tthreshold.on('value', function (data) {\n\t\t\tthresholdValue = data.val();\n\t\t\tview.renderRoadmap(store, thresholdValue);\n\t\t\tview.renderReference(storeReference, thresholdValue);\n\t\t});\n\t\n\t\tfunction broadcast() {\n\t\t\troadmap.set(store);\n\t\t}\n\t\thistory.limitToLast(1).on('child_added', function (childSnapshot) {\n\t\t\tvar event = childSnapshot.val();\n\t\t\tstore.forEach(function (text, index) {\n\t\t\t\tif (text === event.value) {\n\t\t\t\t\tview.renderActionNotification(index, event);\n\t\t\t\t}\n\t\t\t});\n\t\t\t// active user tracking\n\t\t\t$('#user_' + event.visa).removeClass('user-active');\n\t\t\tsetTimeout(function () {\n\t\t\t\t$('#user_' + event.visa).addClass('user-active');\n\t\t\t}, 10);\n\t\t});\n\t\n\t\t// login & presence\n\t\tvar visa;\n\t\tbase.onAuth(function (authData) {\n\t\t\tif (authData) {\n\t\t\t\tvar uid = authData.uid;\n\t\t\t\tconsole.log('Authenticated user with uid:', uid);\n\t\t\t\tbase.child('users/' + uid).on('value', function (data) {\n\t\t\t\t\tvisa = data.val();\n\t\t\t\t\t$('#main, nav, footer').removeClass('hidden');\n\t\t\t\t\t$('#welcome').addClass('hidden');\n\t\t\t\t\t$('#visa').text(visa);\n\t\n\t\t\t\t\t//  online status\n\t\t\t\t\tvar amOnline = base.child('.info/connected');\n\t\t\t\t\tvar userRef = room.child('presence/' + visa);\n\t\t\t\t\tamOnline.on('value', function (snapshot) {\n\t\t\t\t\t\tif (snapshot.val()) {\n\t\t\t\t\t\t\tuserRef.onDisconnect().remove();\n\t\t\t\t\t\t\tuserRef.set(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#welcome').removeClass('hidden');\n\t\t\t\t$('#visa_input').focus();\n\t\t\t\t$('#main, #stats, nav, footer').addClass('hidden');\n\t\t\t\t$('#admin_block').addClass('hidden');\n\t\t\t}\n\t\t});\n\t\tpresence.on('value', function (data) {\n\t\t\tif (data) {\n\t\t\t\tview.displayOnline(data.val());\n\t\t\t}\n\t\t});\n\t\n\t\t/**\n\t  *\n\t  * CHARTING\n\t  *\n\t  */\n\t\tvar chart = c3.generate({\n\t\t\tdata: {\n\t\t\t\tx: 'x',\n\t\t\t\tcolumns: [['x']],\n\t\t\t\ttype: 'area-spline'\n\t\t\t},\n\t\t\taxis: {\n\t\t\t\ty: {\n\t\t\t\t\tpadding: 0\n\t\t\t\t},\n\t\t\t\tx: {\n\t\t\t\t\ttick: {\n\t\t\t\t\t\tformat: function format(x) {\n\t\t\t\t\t\t\tvar time = x * 10000;\n\t\t\t\t\t\t\tvar date = new Date(time);\n\t\t\t\t\t\t\treturn helper.format2(date.getHours()) + ':' + helper.format2(date.getMinutes());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\ttransition: {\n\t\t\t\tduration: 100\n\t\t\t}\n\t\t});\n\t\n\t\tvar times = [];\n\t\tvar saved = [];\n\t\tvar users = {};\n\t\tvar userStats = {};\n\t\tvar itemStats = {};\n\t\tvar nbPoints = 60;\n\t\tvar historyLength = 0;\n\t\n\t\thistory.on('child_added', function (childSnapshot) {\n\t\t\tvar event = childSnapshot.val();\n\t\t\tvar time = event.time;\n\t\t\tvar now = Date.now();\n\t\n\t\t\t// filter event which are too old (>2h)\n\t\t\tif (now - time > 720000) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tsaved.push(event);\n\t\n\t\t\tvar eventVisa = event.visa;\n\t\t\tvar direction = event.direction;\n\t\t\tvar text = event.value;\n\t\t\tvar user = helper.getOrSet(userStats, eventVisa, {\n\t\t\t\tup: 0,\n\t\t\t\tdown: 0,\n\t\t\t\ttotal: 0,\n\t\t\t\ttoRef: 0,\n\t\t\t\tagainstRef: 0\n\t\t\t});\n\t\t\tvar item = helper.getOrSet(itemStats, text, {\n\t\t\t\tup: 0,\n\t\t\t\ttotal: 0,\n\t\t\t\tupUsers: {},\n\t\t\t\tdownUsers: {}\n\t\t\t});\n\t\n\t\t\tuser.total++;\n\t\t\titem.total++;\n\t\n\t\t\tif (direction > 0) {\n\t\t\t\tuser.down++;\n\t\t\t\thelper.getOrSet(item.downUsers, eventVisa, 0);\n\t\t\t\titem.downUsers[eventVisa]++;\n\t\t\t\tif (event.index >= event.refIndex) {\n\t\t\t\t\tuser.againstRef++;\n\t\t\t\t} else {\n\t\t\t\t\tuser.toRef++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem.up++;\n\t\t\t\tuser.up++;\n\t\t\t\thelper.getOrSet(item.upUsers, eventVisa, 0);\n\t\t\t\titem.upUsers[eventVisa]++;\n\t\t\t\tif (event.index <= event.refIndex) {\n\t\t\t\t\tuser.againstRef++;\n\t\t\t\t} else {\n\t\t\t\t\tuser.toRef++;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// show menu link if enough history\n\t\t\tif (historyLength !== -1 && historyLength++ > 10) {\n\t\t\t\t$('#nav_stats').removeClass('hidden');\n\t\t\t\thistoryLength = -1;\n\t\t\t}\n\t\t});\n\t\t// running\n\t\tvar statRules = [{\n\t\t\tid: 'active',\n\t\t\tfn: function fn(user) {\n\t\t\t\treturn user.total;\n\t\t\t}\n\t\t}, {\n\t\t\tid: 'up',\n\t\t\tfn: function fn(user) {\n\t\t\t\treturn user.up * 100 / user.total;\n\t\t\t}\n\t\t}, {\n\t\t\tid: 'ref',\n\t\t\tfn: function fn(user) {\n\t\t\t\treturn user.toRef * 100 / user.total;\n\t\t\t}\n\t\t}];\n\t\n\t\tfunction showUserStats() {\n\t\t\tvar stats = statRules.map(function (rule) {\n\t\t\t\treturn {\n\t\t\t\t\tid: rule.id,\n\t\t\t\t\tmost: {\n\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\tvisa: '???'\n\t\t\t\t\t},\n\t\t\t\t\tless: {\n\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\tvisa: '???'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t\t// compute results\n\t\t\tvar handleRule = function handleRule(currentVisa) {\n\t\t\t\treturn function (rule, index) {\n\t\t\t\t\tvar value = rule.fn(userStats[currentVisa]);\n\t\t\t\t\tvar stat = stats[index];\n\t\t\t\t\tvar most = stat.most;\n\t\t\t\t\tvar less = stat.less;\n\t\t\t\t\tif (most.value === null || value >= most.value) {\n\t\t\t\t\t\tmost.value = value;\n\t\t\t\t\t\tmost.visa = currentVisa;\n\t\t\t\t\t}\n\t\t\t\t\tif (less.value === null || value < less.value) {\n\t\t\t\t\t\tless.value = value;\n\t\t\t\t\t\tless.visa = currentVisa;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t\tfor (var userVisa in userStats) {\n\t\t\t\tstatRules.forEach(handleRule(userVisa));\n\t\t\t}\n\t\t\t// display results\n\t\t\tstats.forEach(function (stat) {\n\t\t\t\t$('#stats_most_' + stat.id + ' .stats-card-visa').text(stat.most.visa);\n\t\t\t\t$('#stats_less_' + stat.id + ' .stats-card-visa').text(stat.less.visa);\n\t\t\t});\n\t\t}\n\t\tsetInterval(function () {\n\t\t\tvar time = Math.floor(Date.now() / 10000);\n\t\t\tvar remaining = [];\n\t\n\t\t\t// initial build\n\t\t\tif (!times.length) {\n\t\t\t\tfor (var i = 0; i < nbPoints; i++) {\n\t\t\t\t\ttimes.unshift(time - i);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// build new time\n\t\t\tvar index = times.indexOf(time);\n\t\t\tif (index === -1) {\n\t\t\t\ttimes.push(time);\n\t\t\t\ttimes.shift();\n\t\t\t\tfor (var key in users) {\n\t\t\t\t\tvar stats = users[key];\n\t\t\t\t\tstats.push(0);\n\t\t\t\t\tstats.shift();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// reintegrate values\n\t\t\tsaved.forEach(function (event) {\n\t\t\t\tvar eventTime = Math.floor(event.time / 10000);\n\t\t\t\tvar eventVisa = event.visa;\n\t\t\t\tvar lastTime = times[times.length - 1];\n\t\t\t\tvar timeIndex = times.indexOf(eventTime);\n\t\t\t\t// save this for later\n\t\t\t\tif (timeIndex === -1 && eventTime > lastTime) {\n\t\t\t\t\tremaining.push(event);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar currentStats = users[eventVisa];\n\t\t\t\tif (!currentStats) {\n\t\t\t\t\tcurrentStats = times.map(function () {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t});\n\t\t\t\t\tusers[eventVisa] = currentStats;\n\t\t\t\t}\n\t\t\t\tvar value = currentStats[index];\n\t\t\t\tcurrentStats[index] = !value ? 1 : value + 1;\n\t\t\t});\n\t\t\tsaved = remaining;\n\t\n\t\t\t// dont process if not showing\n\t\t\tif (!showingStats) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// propagate to chart\n\t\t\tvar columns = [['x'].concat(times)];\n\t\t\tfor (var user in users) {\n\t\t\t\tcolumns.push([user].concat(users[user]));\n\t\t\t}\n\t\t\tchart.load({\n\t\t\t\tcolumns: columns\n\t\t\t});\n\t\t\t// update stats as well\n\t\t\tshowUserStats();\n\t\t}, 2000);\n\t\n\t\t/**\n\t  *\n\t  * DOM HANDLERS\n\t  *\n\t  */\n\t\n\t\t// roadmap handlers\n\t\t$('#nav_admin').on('click', function () {\n\t\t\t$('#admin_block').toggleClass('hidden');\n\t\t\t$('#main').toggleClass('admin');\n\t\t\t$('#admin_roadmap_item').focus();\n\t\t\treturn false;\n\t\t});\n\t\t$('#admin_add').on('submit', function () {\n\t\t\tvar $item = $('#admin_roadmap_item');\n\t\t\tvar value = $item.val();\n\t\t\tif (value) {\n\t\t\t\tstore.push(value);\n\t\t\t\t$item.val('');\n\t\t\t\tbroadcast();\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\t$('#admin_threshold').on('submit', function () {\n\t\t\tvar $item = $('#admin_roadmap_threshold');\n\t\t\tvar value = parseInt($item.val(), 10);\n\t\t\tif (!isNaN(value)) {\n\t\t\t\tthreshold.set(value);\n\t\t\t\t$item.val('');\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\t$('#nav_reference').on('click', function () {\n\t\t\treference.set(store);\n\t\t\treturn false;\n\t\t});\n\t\n\t\t// upload / download\n\t\t$('#roadmap_items_download').on('click', function () {\n\t\t\tvar content = JSON.stringify({\n\t\t\t\tref: storeReference,\n\t\t\t\tstore: store,\n\t\t\t\tthreshold: thresholdValue\n\t\t\t});\n\t\t\thelper.downloadAsFile(new Blob([content], {\n\t\t\t\ttype: 'application/json'\n\t\t\t}), 'roadmap.json');\n\t\t\treturn false;\n\t\t});\n\t\t$('body').on('dragover', function (event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\toriginalEvent.dataTransfer.dropEffect = 'copy';\n\t\t\treturn false;\n\t\t}).on('drop', function (event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\tvar file = originalEvent.dataTransfer.files[0];\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = function (e) {\n\t\t\t\tvar data = null;\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(e.target.result);\n\t\t\t\t} catch (X_x) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (data) {\n\t\t\t\t\tthreshold.set(data.threshold);\n\t\t\t\t\treference.set(data.ref);\n\t\t\t\t\tstore = data.store;\n\t\t\t\t\tbroadcast();\n\t\t\t\t}\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t\treturn false;\n\t\t});\n\t\n\t\t// items handlers\n\t\tfunction swap(direction) {\n\t\t\treturn function () {\n\t\t\t\tvar index = $(this).parents('.roadmap-item').data('index');\n\t\t\t\tif (index === null) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// swap values\n\t\t\t\tvar value = store[index];\n\t\t\t\tstore[index] = store[index + direction];\n\t\t\t\tstore[index + direction] = value;\n\t\t\t\tbroadcast();\n\t\t\t\t// also save changed\n\t\t\t\tif (visa) {\n\t\t\t\t\tvar refIndex = storeReference.indexOf(value);\n\t\t\t\t\tvar historyRef = history.push();\n\t\t\t\t\thistoryRef.set({\n\t\t\t\t\t\tvisa: visa,\n\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\trefIndex: refIndex,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttime: Firebase.ServerValue.TIMESTAMP,\n\t\t\t\t\t\tdirection: direction\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\t\n\t\t$('#roadmap_items').on('click', '.roadmap-item-up', swap(-1)).on('click', '.roadmap-item-down', swap(1)).on('click', '.roadmap-item-delete', function () {\n\t\t\tvar index = $(this).parents('.roadmap-item').data('index');\n\t\t\tstore.splice(index, 1);\n\t\t\tbroadcast();\n\t\t\treturn false;\n\t\t}).on('dragstart', '.roadmap-item', function (event) {\n\t\t\tif (!$('#main').hasClass('admin')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\tvar $item = $(this);\n\t\t\t$item.addClass('roadmap-item-dragging');\n\t\t\toriginalEvent.dataTransfer.effectAllowed = 'move';\n\t\t\toriginalEvent.dataTransfer.setData('application/json', JSON.stringify({\n\t\t\t\tindex: $item.data('index'),\n\t\t\t\titem: $item.find('.roadmap-item-name').text()\n\t\t\t}));\n\t\t\t// delay target placeholder display, otherwise stops the drag because\n\t\t\t// of the next element\n\t\t\tsetTimeout(function () {\n\t\t\t\t$('#roadmap_items .roadmap-item:not(.roadmap-item-dragging)').addClass('roadmap-item-drop-target');\n\t\t\t}, 100);\n\t\t}).on('dragenter', '.roadmap-item', function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.hasClass('roadmap-item-drop-target')) {\n\t\t\t\t$(this).addClass('roadmap-item-drop-target-enter');\n\t\t\t}\n\t\t}).on('dragover', '.roadmap-item', function (event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\toriginalEvent.dataTransfer.dropEffect = 'move';\n\t\t\treturn false;\n\t\t}).on('dragleave', '.roadmap-item', function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tvar $this = $(this);\n\t\t\t$this.removeClass('roadmap-item-drop-target-enter');\n\t\t}).on('dragend', '.roadmap-item', function () {\n\t\t\t$(this).removeClass('roadmap-item-dragging');\n\t\t\t$('#roadmap_items .roadmap-item').removeClass('roadmap-item-drop-target').removeClass('roadmap-item-drop-target-enter');\n\t\t}).on('drop', '.roadmap-item', function (event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\tvar targetIndex = $(this).data('index');\n\t\t\tvar originIndex = JSON.parse(originalEvent.dataTransfer.getData('application/json')).index;\n\t\t\t// no index : push at the end\n\t\t\tif (targetIndex !== 0 && !targetIndex) {\n\t\t\t\ttargetIndex = store.length;\n\t\t\t}\n\t\t\t// removing will shift the index\n\t\t\tif (originIndex < targetIndex) {\n\t\t\t\ttargetIndex--;\n\t\t\t}\n\t\t\tvar item = store.splice(originIndex, 1);\n\t\t\tstore.splice(targetIndex, 0, item);\n\t\t\tbroadcast();\n\t\t\treturn false;\n\t\t});\n\t\n\t\t// login handlers\n\t\t$('#welcome form').on('submit', function (event) {\n\t\n\t\t\tevent.preventDefault();\n\t\t\t// toggle display\n\t\t\t$(this).hide();\n\t\t\t$('#welcome .progress').removeClass('hidden');\n\t\t\tvar login = $('#visa_input').val();\n\t\n\t\t\tbase.authAnonymously(function (error, authData) {\n\t\t\t\tif (error) {\n\t\t\t\t\tconsole.log('Authentication Failed!', error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar uid = authData.uid;\n\t\t\t\tbase.child('users/' + uid).set(login);\n\t\t\t\t$('#welcome').hide();\n\t\t\t\t$('#welcome form').show();\n\t\t\t\t$('#welcome').addClass('hidden');\n\t\t\t\t$('#welcome .progress').addClass('hidden');\n\t\t\t});\n\t\t});\n\t\t$('#nav_logout').on('click', function () {\n\t\t\tbase.unauth();\n\t\t\treturn false;\n\t\t});\n\t\n\t\t$('#nav_stats, #stats h2 .close').on('click', function () {\n\t\t\t$('#stats, #main').toggleClass('hidden');\n\t\t\tshowingStats = !showingStats;\n\t\t\tif (showingStats) {\n\t\t\t\tshowUserStats();\n\t\t\t\tif ($('#main').hasClass('admin')) {\n\t\t\t\t\t$('#nav_admin').trigger('click');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\t$('#nav_toggle').on('click', function () {\n\t\t\t$('nav .navbar-right').toggleClass('hidden-xs');\n\t\t});\n\t});\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\texports.format2 = format2;\n\texports.downloadAsFile = downloadAsFile;\n\texports.getOrSet = getOrSet;\n\t\n\tfunction format2(int) {\n\t\treturn int < 10 ? '0' + int : '' + int;\n\t}\n\t\n\t// stolen from piskel\n\t\n\tfunction downloadAsFile(content, filename) {\n\t\tvar saveAs = window.saveAs || navigator.msSaveBlob && navigator.msSaveBlob.bind(navigator);\n\t\tif (saveAs) {\n\t\t\tsaveAs(content, filename);\n\t\t} else {\n\t\t\tvar downloadLink = document.createElement('a');\n\t\t\tvar href = window.URL.createObjectURL(content);\n\t\t\tdownloadLink.setAttribute('href', href);\n\t\t\tdownloadLink.setAttribute('download', filename);\n\t\t\tdocument.body.appendChild(downloadLink);\n\t\t\tdownloadLink.click();\n\t\t\tdocument.body.removeChild(downloadLink);\n\t\t}\n\t}\n\t\n\tfunction getOrSet(object, key, defaultValue) {\n\t\tvar value = object[key];\n\t\tif (value) {\n\t\t\treturn value;\n\t\t}\n\t\tobject[key] = defaultValue;\n\t\treturn defaultValue;\n\t}\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t/*global $:true*/\n\t\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\texports.createElement = createElement;\n\texports.renderRoadmap = renderRoadmap;\n\texports.renderReference = renderReference;\n\texports.displayOnline = displayOnline;\n\texports.renderActionNotification = renderActionNotification;\n\t\n\tfunction createElement(text, index, total, changed, isReference, isCandidate) {\n\t    var markup = ['<div class=\"roadmap-item clearfix ' + (isCandidate ? 'roadmap-item-candidate' : '') + '\"' + (!isReference ? 'id=\"roadmap_item_' + index + '\"' : '') + '  draggable=\"true\">', '<div>'];\n\t\n\t    if (!isReference) {\n\t        markup.push('<span class=\"roadmap-item-grab-handle glyphicon glyphicon-move\"></span>');\n\t    }\n\t\n\t    markup.push('<span class=\"roadmap-item-name\"></span>');\n\t\n\t    if (!isReference) {\n\t        var isNotLast = total && total - 1 !== index;\n\t        markup = markup.concat(['<span class=\"roadmap-author\"></span>', isNotLast ? '<a href=\"#\" class=\"roadmap-item-down\">' : '', isNotLast ? '<span class=\"glyphicon glyphicon-arrow-down\" aria-hidden=\"true\"></span>' : '', isNotLast ? '</a>' : '', index ? '<a href=\"#\" class=\"roadmap-item-up\">' : '', index ? '<span class=\"glyphicon glyphicon-arrow-up\" aria-hidden=\"true\"></span>' : '', index ? '</a>' : '', '<a href=\"#\" class=\"roadmap-item-delete\">', '<span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\"></span>', '</a>']);\n\t    }\n\t\n\t    markup.push('</div></div>');\n\t\n\t    var $element = $(markup.join(''));\n\t    $element.data('index', index);\n\t    $element.find('.roadmap-item-name').text(text);\n\t    $element.attr('title', text);\n\t    if (changed) {\n\t        $element.addClass('roadmap-item-new');\n\t    }\n\t    return $element;\n\t}\n\t\n\tvar storeView = [];\n\tvar thresholdMarkup = '<h5>Candidates</h5>';\n\t\n\tfunction renderRoadmap(store, thresholdValue) {\n\t    var $elementContainer = $('#roadmap_items');\n\t    var newStoreView = [];\n\t    var nbItems = store.length;\n\t    $elementContainer.html('');\n\t    if (nbItems) {\n\t        $('#roadmap_items_tips').addClass('hidden');\n\t        store.forEach(function (text, index) {\n\t            if (thresholdValue && index === thresholdValue) {\n\t                $elementContainer.append(thresholdMarkup);\n\t            }\n\t            $elementContainer.append(createElement(text, index, nbItems, storeView[index] !== text, false, index >= thresholdValue));\n\t            newStoreView[index] = text;\n\t        });\n\t        // add last element for DnD\n\t        $elementContainer.append('<div class=\"roadmap-item clearfix\"></div>');\n\t    } else {\n\t        $('#roadmap_items_tips').removeClass('hidden');\n\t    }\n\t    // keep a copy for the view\n\t    storeView = newStoreView;\n\t}\n\t\n\tfunction renderReference(storeReference, thresholdValue) {\n\t    var $elementContainer = $('#reference_items');\n\t    $elementContainer.html('');\n\t    storeReference.forEach(function (text, index) {\n\t        if (thresholdValue && index === thresholdValue) {\n\t            $elementContainer.append(thresholdMarkup);\n\t        }\n\t        $elementContainer.append(createElement(text, index, null, true, true, index >= thresholdValue));\n\t    });\n\t}\n\t\n\tfunction displayOnline(online) {\n\t    var $online = $('#online');\n\t    $online.html('');\n\t    for (var key in online) {\n\t        if (online[key]) {\n\t            $online.append('<li id=\"user_' + key + '\">' + key + '</li>');\n\t        }\n\t    }\n\t}\n\t\n\tfunction renderActionNotification(index, event) {\n\t    var $item = $('#roadmap_item_' + index + ' > div');\n\t    $item.removeClass('roadmap-item-notif-up, roadmap-item-notif-down');\n\t    $('.roadmap-author', $item).text(event.visa).removeClass('roadmap-author-new');\n\t    setTimeout(function () {\n\t        $item.addClass('roadmap-item-notif-' + (event.direction < 0 ? 'up' : 'down'));\n\t        $('.roadmap-author', $item).addClass('roadmap-author-new');\n\t    }, 10);\n\t}\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** roadmap.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 5a9e414fcffb9faf73de\n **/","/*global $ Firebase c3:true*/\nimport * as helper from './helper';\nimport * as view from './view';\n\n$(function() {\n\n\tvar hash = 'room_' + window.location.hash.replace(/[\\#\\.\\[\\]\\$]/g, '');\n\t// DEV - PROD switch\n\tvar baseDomain = window.location.host.indexOf('localhost') !== -1 ? 'roadmap2' : 'amber-torch-7267';\n\n\tvar base = new Firebase('https://' + baseDomain + '.firebaseio.com/');\n\tvar room = base.child(hash);\n\tvar roadmap = room.child('roadmap');\n\tvar reference = room.child('reference');\n\tvar threshold = room.child('threshold');\n\tvar history = room.child('history');\n\tvar presence = room.child('presence');\n\n\t/**\n\t *\n\t * SHARED VARS\n\t *\n\t */\n\n\tvar store = [];\n\tvar storeReference = [];\n\tvar thresholdValue = 0;\n\tvar showingStats = false;\n\n\t/**\n\t *\n\t * FUNCTIONAL\n\t *\n\t */\n\n\troadmap.on('value', function(newStoreResp) {\n\t\tstore = newStoreResp.val() || [];\n\t\tview.renderRoadmap(store, thresholdValue);\n\t});\n\treference.on('value', function(data) {\n\t\tstoreReference = data.val() || [];\n\t\tview.renderReference(storeReference, thresholdValue);\n\n\t});\n\tthreshold.on('value', function(data) {\n\t\tthresholdValue = data.val();\n\t\tview.renderRoadmap(store, thresholdValue);\n\t\tview.renderReference(storeReference, thresholdValue);\n\t});\n\n\tfunction broadcast() {\n\t\troadmap.set(store);\n\t}\n\thistory.limitToLast(1).on('child_added', function(childSnapshot) {\n\t\tvar event = childSnapshot.val();\n\t\tstore.forEach(function(text, index) {\n\t\t\tif (text === event.value) {\n\t\t\t\tview.renderActionNotification(index, event);\n\t\t\t}\n\t\t});\n\t\t// active user tracking\n\t\t$('#user_' + event.visa).removeClass('user-active');\n\t\tsetTimeout(function() {\n\t\t\t$('#user_' + event.visa).addClass('user-active');\n\t\t}, 10);\n\t});\n\n\t// login & presence\n\tvar visa;\n\tbase.onAuth(function(authData) {\n\t\tif (authData) {\n\t\t\tvar uid = authData.uid;\n\t\t\tconsole.log('Authenticated user with uid:', uid);\n\t\t\tbase.child('users/' + uid).on('value', function(data) {\n\t\t\t\tvisa = data.val();\n\t\t\t\t$('#main, nav, footer').removeClass('hidden');\n\t\t\t\t$('#welcome').addClass('hidden');\n\t\t\t\t$('#visa').text(visa);\n\n\t\t\t\t//  online status\n\t\t\t\tvar amOnline = base.child('.info/connected');\n\t\t\t\tvar userRef = room.child('presence/' + visa);\n\t\t\t\tamOnline.on('value', function(snapshot) {\n\t\t\t\t\tif (snapshot.val()) {\n\t\t\t\t\t\tuserRef.onDisconnect().remove();\n\t\t\t\t\t\tuserRef.set(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\t$('#welcome').removeClass('hidden');\n\t\t\t$('#visa_input').focus();\n\t\t\t$('#main, #stats, nav, footer').addClass('hidden');\n\t\t\t$('#admin_block').addClass('hidden');\n\t\t}\n\t});\n\tpresence.on('value', function(data) {\n\t\tif (data) {\n\t\t\tview.displayOnline(data.val());\n\t\t}\n\t});\n\n\t/**\n\t *\n\t * CHARTING\n\t *\n\t */\n\tvar chart = c3.generate({\n\t\tdata: {\n\t\t\tx: 'x',\n\t\t\tcolumns: [\n\t\t\t\t['x'],\n\t\t\t],\n\t\t\ttype: 'area-spline'\n\t\t},\n\t\taxis: {\n\t\t\ty: {\n\t\t\t\tpadding: 0\n\t\t\t},\n\t\t\tx: {\n\t\t\t\ttick: {\n\t\t\t\t\tformat: function(x) {\n\t\t\t\t\t\tvar time = x * 10000;\n\t\t\t\t\t\tvar date = new Date(time);\n\t\t\t\t\t\treturn helper.format2(date.getHours()) + ':' + helper.format2(date.getMinutes());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ttransition: {\n\t\t\tduration: 100\n\t\t}\n\t});\n\n\n\tvar times = [];\n\tvar saved = [];\n\tvar users = {};\n\tvar userStats = {};\n\tvar itemStats = {};\n\tvar nbPoints = 60;\n\tvar historyLength = 0;\n\n\thistory.on('child_added', function(childSnapshot) {\n\t\tvar event = childSnapshot.val();\n\t\tvar time = event.time;\n\t\tvar now = Date.now();\n\n\t\t// filter event which are too old (>2h)\n\t\tif (now - time > 720000) {\n\t\t\treturn;\n\t\t}\n\n\t\tsaved.push(event);\n\n\t\tvar eventVisa = event.visa;\n\t\tvar direction = event.direction;\n\t\tvar text = event.value;\n\t\tvar user = helper.getOrSet(userStats, eventVisa, {\n\t\t\tup: 0,\n\t\t\tdown: 0,\n\t\t\ttotal: 0,\n\t\t\ttoRef: 0,\n\t\t\tagainstRef: 0\n\t\t});\n\t\tvar item = helper.getOrSet(itemStats, text, {\n\t\t\tup: 0,\n\t\t\ttotal: 0,\n\t\t\tupUsers: {},\n\t\t\tdownUsers: {}\n\t\t});\n\n\t\tuser.total++;\n\t\titem.total++;\n\n\t\tif (direction > 0) {\n\t\t\tuser.down++;\n\t\t\thelper.getOrSet(item.downUsers, eventVisa, 0);\n\t\t\titem.downUsers[eventVisa]++;\n\t\t\tif (event.index >= event.refIndex) {\n\t\t\t\tuser.againstRef++;\n\t\t\t} else {\n\t\t\t\tuser.toRef++;\n\t\t\t}\n\t\t} else {\n\t\t\titem.up++;\n\t\t\tuser.up++;\n\t\t\thelper.getOrSet(item.upUsers, eventVisa, 0);\n\t\t\titem.upUsers[eventVisa]++;\n\t\t\tif (event.index <= event.refIndex) {\n\t\t\t\tuser.againstRef++;\n\t\t\t} else {\n\t\t\t\tuser.toRef++;\n\t\t\t}\n\t\t}\n\n\t\t// show menu link if enough history\n\t\tif (historyLength !== -1 && historyLength++ > 10) {\n\t\t\t$('#nav_stats').removeClass('hidden');\n\t\t\thistoryLength = -1;\n\t\t}\n\t});\n\t// running\n\tvar statRules = [{\n\t\tid: 'active',\n\t\tfn: function(user) {\n\t\t\treturn user.total;\n\t\t}\n\t}, {\n\t\tid: 'up',\n\t\tfn: function(user) {\n\t\t\treturn user.up * 100 / user.total;\n\t\t}\n\t}, {\n\t\tid: 'ref',\n\t\tfn: function(user) {\n\t\t\treturn user.toRef * 100 / user.total;\n\t\t}\n\t}];\n\n\tfunction showUserStats() {\n\t\tvar stats = statRules.map(function(rule) {\n\t\t\treturn {\n\t\t\t\tid: rule.id,\n\t\t\t\tmost: {\n\t\t\t\t\tvalue: null,\n\t\t\t\t\tvisa: '???'\n\t\t\t\t},\n\t\t\t\tless: {\n\t\t\t\t\tvalue: null,\n\t\t\t\t\tvisa: '???'\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t\t// compute results\n\t\tvar handleRule = function(currentVisa) {\n\t\t\treturn function(rule, index) {\n\t\t\t\tvar value = rule.fn(userStats[currentVisa]);\n\t\t\t\tvar stat = stats[index];\n\t\t\t\tvar most = stat.most;\n\t\t\t\tvar less = stat.less;\n\t\t\t\tif (most.value === null || value >= most.value) {\n\t\t\t\t\tmost.value = value;\n\t\t\t\t\tmost.visa = currentVisa;\n\t\t\t\t}\n\t\t\t\tif (less.value === null || value < less.value) {\n\t\t\t\t\tless.value = value;\n\t\t\t\t\tless.visa = currentVisa;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tfor (var userVisa in userStats) {\n\t\t\tstatRules.forEach(handleRule(userVisa));\n\t\t}\n\t\t// display results\n\t\tstats.forEach(function(stat) {\n\t\t\t$('#stats_most_' + stat.id + ' .stats-card-visa').text(stat.most.visa);\n\t\t\t$('#stats_less_' + stat.id + ' .stats-card-visa').text(stat.less.visa);\n\t\t});\n\t}\n\tsetInterval(function() {\n\t\tvar time = Math.floor(Date.now() / 10000);\n\t\tvar remaining = [];\n\n\t\t// initial build\n\t\tif (!times.length) {\n\t\t\tfor (var i = 0; i < nbPoints; i++) {\n\t\t\t\ttimes.unshift(time - i);\n\t\t\t}\n\t\t}\n\n\t\t// build new time\n\t\tvar index = times.indexOf(time);\n\t\tif (index === -1) {\n\t\t\ttimes.push(time);\n\t\t\ttimes.shift();\n\t\t\tfor (var key in users) {\n\t\t\t\tvar stats = users[key];\n\t\t\t\tstats.push(0);\n\t\t\t\tstats.shift();\n\n\t\t\t}\n\t\t}\n\n\t\t// reintegrate values\n\t\tsaved.forEach(function(event) {\n\t\t\tvar eventTime = Math.floor(event.time / 10000);\n\t\t\tvar eventVisa = event.visa;\n\t\t\tvar lastTime = times[times.length - 1];\n\t\t\tvar timeIndex = times.indexOf(eventTime);\n\t\t\t// save this for later\n\t\t\tif (timeIndex === -1 && eventTime > lastTime) {\n\t\t\t\tremaining.push(event);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar currentStats = users[eventVisa];\n\t\t\tif (!currentStats) {\n\t\t\t\tcurrentStats = times.map(function() {\n\t\t\t\t\treturn 0;\n\t\t\t\t});\n\t\t\t\tusers[eventVisa] = currentStats;\n\t\t\t}\n\t\t\tvar value = currentStats[index];\n\t\t\tcurrentStats[index] = !value ? 1 : value + 1;\n\t\t});\n\t\tsaved = remaining;\n\n\t\t// dont process if not showing\n\t\tif (!showingStats) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// propagate to chart\n\t\tvar columns = [\n\t\t\t['x'].concat(times)\n\t\t];\n\t\tfor (var user in users) {\n\t\t\tcolumns.push([user].concat(users[user]));\n\t\t}\n\t\tchart.load({\n\t\t\tcolumns: columns\n\t\t});\n\t\t// update stats as well\n\t\tshowUserStats();\n\t}, 2000);\n\n\t/**\n\t *\n\t * DOM HANDLERS\n\t *\n\t */\n\n\t// roadmap handlers\n\t$('#nav_admin').on('click', function() {\n\t\t$('#admin_block').toggleClass('hidden');\n\t\t$('#main').toggleClass('admin');\n\t\t$('#admin_roadmap_item').focus();\n\t\treturn false;\n\t});\n\t$('#admin_add').on('submit', function() {\n\t\tvar $item = $('#admin_roadmap_item');\n\t\tvar value = $item.val();\n\t\tif (value) {\n\t\t\tstore.push(value);\n\t\t\t$item.val('');\n\t\t\tbroadcast();\n\t\t}\n\t\treturn false;\n\t});\n\t$('#admin_threshold').on('submit', function() {\n\t\tvar $item = $('#admin_roadmap_threshold');\n\t\tvar value = parseInt($item.val(), 10);\n\t\tif (!isNaN(value)) {\n\t\t\tthreshold.set(value);\n\t\t\t$item.val('');\n\t\t}\n\t\treturn false;\n\t});\n\t$('#nav_reference').on('click', function() {\n\t\treference.set(store);\n\t\treturn false;\n\t});\n\n\t// upload / download\n\t$('#roadmap_items_download').on('click', function() {\n\t\tvar content = JSON.stringify({\n\t\t\tref: storeReference,\n\t\t\tstore: store,\n\t\t\tthreshold: thresholdValue\n\t\t});\n\t\thelper.downloadAsFile(new Blob([content], {\n\t\t\ttype: 'application/json'\n\t\t}), 'roadmap.json');\n\t\treturn false;\n\t});\n\t$('body')\n\t\t.on('dragover', function(event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\toriginalEvent.dataTransfer.dropEffect = 'copy';\n\t\t\treturn false;\n\t\t})\n\t\t.on('drop', function(event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\tvar file = originalEvent.dataTransfer.files[0];\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = function(e) {\n\t\t\t\tvar data = null;\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(e.target.result);\n\t\t\t\t} catch (X_x) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (data) {\n\t\t\t\t\tthreshold.set(data.threshold);\n\t\t\t\t\treference.set(data.ref);\n\t\t\t\t\tstore = data.store;\n\t\t\t\t\tbroadcast();\n\t\t\t\t}\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t\treturn false;\n\t\t});\n\n\t// items handlers\n\tfunction swap(direction) {\n\t\treturn function() {\n\t\t\tvar index = $(this).parents('.roadmap-item').data('index');\n\t\t\tif (index === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// swap values\n\t\t\tvar value = store[index];\n\t\t\tstore[index] = store[index + direction];\n\t\t\tstore[index + direction] = value;\n\t\t\tbroadcast();\n\t\t\t// also save changed\n\t\t\tif (visa) {\n\t\t\t\tvar refIndex = storeReference.indexOf(value);\n\t\t\t\tvar historyRef = history.push();\n\t\t\t\thistoryRef.set({\n\t\t\t\t\tvisa: visa,\n\t\t\t\t\tindex: index,\n\t\t\t\t\trefIndex: refIndex,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\ttime: Firebase.ServerValue.TIMESTAMP,\n\t\t\t\t\tdirection: direction\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t}\n\n\t$('#roadmap_items')\n\t\t.on('click', '.roadmap-item-up', swap(-1))\n\t\t.on('click', '.roadmap-item-down', swap(1))\n\t\t.on('click', '.roadmap-item-delete', function() {\n\t\t\tvar index = $(this).parents('.roadmap-item').data('index');\n\t\t\tstore.splice(index, 1);\n\t\t\tbroadcast();\n\t\t\treturn false;\n\t\t})\n\t\t.on('dragstart', '.roadmap-item', function(event) {\n\t\t\tif (!$('#main').hasClass('admin')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\tvar $item = $(this);\n\t\t\t$item.addClass('roadmap-item-dragging');\n\t\t\toriginalEvent.dataTransfer.effectAllowed = 'move';\n\t\t\toriginalEvent.dataTransfer.setData('application/json', JSON.stringify({\n\t\t\t\tindex: $item.data('index'),\n\t\t\t\titem: $item.find('.roadmap-item-name').text()\n\t\t\t}));\n\t\t\t// delay target placeholder display, otherwise stops the drag because\n\t\t\t// of the next element\n\t\t\tsetTimeout(function() {\n\t\t\t\t$('#roadmap_items .roadmap-item:not(.roadmap-item-dragging)').addClass('roadmap-item-drop-target');\n\t\t\t}, 100);\n\t\t})\n\t\t.on('dragenter', '.roadmap-item', function() {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.hasClass('roadmap-item-drop-target')) {\n\t\t\t\t$(this).addClass('roadmap-item-drop-target-enter');\n\t\t\t}\n\t\t})\n\t\t.on('dragover', '.roadmap-item', function(event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\toriginalEvent.dataTransfer.dropEffect = 'move';\n\t\t\treturn false;\n\t\t})\n\t\t.on('dragleave', '.roadmap-item', function(event) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tvar $this = $(this);\n\t\t\t$this.removeClass('roadmap-item-drop-target-enter');\n\n\t\t})\n\t\t.on('dragend', '.roadmap-item', function() {\n\t\t\t$(this).removeClass('roadmap-item-dragging');\n\t\t\t$('#roadmap_items .roadmap-item').removeClass('roadmap-item-drop-target')\n\t\t\t\t.removeClass('roadmap-item-drop-target-enter');\n\t\t})\n\t\t.on('drop', '.roadmap-item', function(event) {\n\t\t\tvar originalEvent = event.originalEvent;\n\t\t\tvar targetIndex = $(this).data('index');\n\t\t\tvar originIndex = JSON.parse(originalEvent.dataTransfer.getData('application/json')).index;\n\t\t\t// no index : push at the end\n\t\t\tif (targetIndex !== 0 && !targetIndex) {\n\t\t\t\ttargetIndex = store.length;\n\t\t\t}\n\t\t\t// removing will shift the index\n\t\t\tif (originIndex < targetIndex) {\n\t\t\t\ttargetIndex--;\n\t\t\t}\n\t\t\tvar item = store.splice(originIndex, 1);\n\t\t\tstore.splice(targetIndex, 0, item);\n\t\t\tbroadcast();\n\t\t\treturn false;\n\t\t});\n\n\t// login handlers\n\t$('#welcome form').on('submit', function(event) {\n\n\t\tevent.preventDefault();\n\t\t// toggle display\n\t\t$(this).hide();\n\t\t$('#welcome .progress').removeClass('hidden');\n\t\tvar login = $('#visa_input').val();\n\n\t\tbase.authAnonymously(function(error, authData) {\n\t\t\tif (error) {\n\t\t\t\tconsole.log('Authentication Failed!', error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar uid = authData.uid;\n\t\t\tbase.child('users/' + uid).set(login);\n\t\t\t$('#welcome').hide();\n\t\t\t$('#welcome form').show();\n\t\t\t$('#welcome').addClass('hidden');\n\t\t\t$('#welcome .progress').addClass('hidden');\n\t\t});\n\t});\n\t$('#nav_logout').on('click', function() {\n\t\tbase.unauth();\n\t\treturn false;\n\t});\n\n\t$('#nav_stats, #stats h2 .close').on('click', function() {\n\t\t$('#stats, #main').toggleClass('hidden');\n\t\tshowingStats = !showingStats;\n\t\tif (showingStats) {\n\t\t\tshowUserStats();\n\t\t\tif ($('#main').hasClass('admin')) {\n\t\t\t\t$('#nav_admin').trigger('click');\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t});\n\t$('#nav_toggle').on('click', function() {\n\t\t$('nav .navbar-right').toggleClass('hidden-xs');\n\t});\n\n});\n\n\n\n/** WEBPACK FOOTER **\n ** C:/Users/BBA/Documents/GitHub/roadmap/source/js/roadmap.js\n **/","export function format2(int) {\n\treturn int < 10 ? '0' + int : '' + int;\n}\n\n// stolen from piskel\nexport function downloadAsFile(content, filename) {\n\tvar saveAs = window.saveAs || (navigator.msSaveBlob && navigator.msSaveBlob.bind(navigator));\n\tif (saveAs) {\n\t\tsaveAs(content, filename);\n\t} else {\n\t\tvar downloadLink = document.createElement('a');\n\t\tvar href = window.URL.createObjectURL(content);\n\t\tdownloadLink.setAttribute('href', href);\n\t\tdownloadLink.setAttribute('download', filename);\n\t\tdocument.body.appendChild(downloadLink);\n\t\tdownloadLink.click();\n\t\tdocument.body.removeChild(downloadLink);\n\t}\n}\n\nexport function getOrSet(object, key, defaultValue) {\n\tvar value = object[key];\n\tif (value) {\n\t\treturn value;\n\t}\n\tobject[key] = defaultValue;\n\treturn defaultValue;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** C:/Users/BBA/Documents/GitHub/roadmap/source/js/helper.js\n **/","/*global $:true*/\r\n\r\nexport function createElement(text, index, total, changed, isReference, isCandidate) {\r\n    let markup = [\r\n        '<div class=\"roadmap-item clearfix ' + (isCandidate ? 'roadmap-item-candidate' : '') + '\"' +\r\n        (!isReference ? 'id=\"roadmap_item_' + index + '\"' : '') + '  draggable=\"true\">',\r\n        '<div>'\r\n    ];\r\n\r\n    if (!isReference) {\r\n        markup.push('<span class=\"roadmap-item-grab-handle glyphicon glyphicon-move\"></span>');\r\n    }\r\n\r\n    markup.push('<span class=\"roadmap-item-name\"></span>');\r\n\r\n    if (!isReference) {\r\n        let isNotLast = total && total - 1 !== index;\r\n        markup = markup.concat([\r\n            '<span class=\"roadmap-author\"></span>',\r\n            isNotLast ? '<a href=\"#\" class=\"roadmap-item-down\">' : '',\r\n            isNotLast ? '<span class=\"glyphicon glyphicon-arrow-down\" aria-hidden=\"true\"></span>' : '',\r\n            isNotLast ? '</a>' : '',\r\n            index ? '<a href=\"#\" class=\"roadmap-item-up\">' : '',\r\n            index ? '<span class=\"glyphicon glyphicon-arrow-up\" aria-hidden=\"true\"></span>' : '',\r\n            index ? '</a>' : '',\r\n            '<a href=\"#\" class=\"roadmap-item-delete\">',\r\n            '<span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\"></span>',\r\n            '</a>'\r\n        ]);\r\n    }\r\n\r\n    markup.push('</div></div>');\r\n\r\n    let $element = $(markup.join(''));\r\n    $element.data('index', index);\r\n    $element.find('.roadmap-item-name').text(text);\r\n    $element.attr('title', text);\r\n    if (changed) {\r\n        $element.addClass('roadmap-item-new');\r\n    }\r\n    return $element;\r\n}\r\n\r\nvar storeView = [];\r\nvar thresholdMarkup = '<h5>Candidates</h5>';\r\n\r\nexport function renderRoadmap(store, thresholdValue) {\r\n    let $elementContainer = $('#roadmap_items');\r\n    let newStoreView = [];\r\n    let nbItems = store.length;\r\n    $elementContainer.html('');\r\n    if (nbItems) {\r\n        $('#roadmap_items_tips').addClass('hidden');\r\n        store.forEach(function(text, index) {\r\n            if (thresholdValue && index === thresholdValue) {\r\n                $elementContainer.append(thresholdMarkup);\r\n            }\r\n            $elementContainer.append(createElement(text, index, nbItems, storeView[index] !== text, false, index >= thresholdValue));\r\n            newStoreView[index] = text;\r\n        });\r\n        // add last element for DnD\r\n        $elementContainer.append('<div class=\"roadmap-item clearfix\"></div>');\r\n    } else {\r\n        $('#roadmap_items_tips').removeClass('hidden');\r\n    }\r\n    // keep a copy for the view\r\n    storeView = newStoreView;\r\n}\r\n\r\nexport function renderReference(storeReference, thresholdValue) {\r\n    let $elementContainer = $('#reference_items');\r\n    $elementContainer.html('');\r\n    storeReference.forEach(function(text, index) {\r\n        if (thresholdValue && index === thresholdValue) {\r\n            $elementContainer.append(thresholdMarkup);\r\n        }\r\n        $elementContainer.append(createElement(text, index, null, true, true, index >= thresholdValue));\r\n    });\r\n}\r\n\r\nexport function displayOnline(online) {\r\n    let $online = $('#online');\r\n    $online.html('');\r\n    for (let key in online) {\r\n        if (online[key]) {\r\n            $online.append(`<li id=\"user_${key}\">${key}</li>`);\r\n        }\r\n    }\r\n}\r\n\r\nexport function renderActionNotification(index, event) {\r\n    let $item = $('#roadmap_item_' + index + ' > div');\r\n    $item.removeClass('roadmap-item-notif-up, roadmap-item-notif-down');\r\n    $('.roadmap-author', $item)\r\n        .text(event.visa)\r\n        .removeClass('roadmap-author-new');\r\n    setTimeout(function() {\r\n        $item.addClass('roadmap-item-notif-' + (event.direction < 0 ? 'up' : 'down'));\r\n        $('.roadmap-author', $item)\r\n            .addClass('roadmap-author-new');\r\n    }, 10);\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** C:/Users/BBA/Documents/GitHub/roadmap/source/js/view.js\n **/"],"sourceRoot":""}